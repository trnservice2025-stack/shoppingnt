<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>í‹°ë‘ì´ í…ŒìŠ¤íŠ¸</title>
<script src="https://code.jquery.com/jquery-latest.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<style>
	body,div,dl,dt,dd,ul,ol,li,h1,h2,h3,h4,h5,h6,p,table,th,td,form,fieldset,legend,textarea,input,select,textarea,button{margin:0;padding:0; -webkit-text-size-adjust:none; outline:none; word-break:keep-all;}
	html,body{height:100%;}
	body {overflow-x:hidden; overflow-y:scroll; min-width:320px;}
	body,input,select,textarea,button,pre{font-family:'Noto Sans KR','Nanum Gothic','Malgun Gothic','ë§‘ì€ê³ ë”•','Apple SD Gothic Neo',Dotum,'ë‹ì›€',sans-serif; color:#1e1e1e; font-weight:400;}
	fieldset,li,img{border:0;vertical-align:top;outline:none;}
	ul,ol{list-style:none}
	button{overflow:visible;border:0;background-color:transparent;cursor:pointer;outline:none;}
	a, button {-webkit-tap-highlight-color:transparent; color:#1e1e1e;}
	table{border-collapse:collapse;border-spacing:0}
	caption {display:none;}

	@font-face {
		font-family: 'RoundedFixedsys';
		src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_six@1.2/DungGeunMo.woff') format('woff');
		font-weight: normal;
		font-display: swap;
	}

	body {background:#fbfbfb;}
	.wrap {max-width:800px; margin:0 auto; padding:30px;}
	.section {display:none;}
	.section.active {display:block;}
	.section>div {padding:50px; margin:30px 0; background:#fff; box-shadow:0 2px 8px rgba(0,0,0,.1); border-radius:40px; text-align:center; font-size:20px;}
	.section h3 {font-size:24px; margin-bottom:30px;}
	.title {font-family: 'RoundedFixedsys'; text-align:center;}
	.title dt {font-size:40px; color:#ff69bc; margin-bottom:20px;}
	.title dd {font-size:20px; line-height:32px;  }
	.title dd img {display:block; margin:0 auto; height:200px; margin-top:20px;}
	.section input[type="text"], .section select, .section button {cursor:pointer; border-radius:18px; padding:20px 20px; font-size:20px; border:0; box-shadow:0 2px 8px rgba(0,0,0,.1);}
	.section select {margin-bottom:30px; appearance: none; padding-right:50px;
		-webkit-appearance: none;
		-moz-appearance: none; background-image: url("data:image/svg+xml;utf8,<svg fill='%23000000' height='20' width='20' xmlns='http://www.w3.org/2000/svg'><path d='M5 7l5 5 5-5z'/></svg>");
		background-repeat: no-repeat;
		background-position: right 20px center;
		background-size: 20px;}
		.section  select:disabled {
		background-color: #f5f5f5;
		color: #aaa;
		border-color: #ddd;
		cursor: not-allowed;
		background-image: url("data:image/svg+xml;utf8,<svg fill='%23a7a7a7' height='20' width='20' xmlns='http://www.w3.org/2000/svg'><path d='M5 7l5 5 5-5z'/></svg>");
	}
	.section button {background:#ff69bc; color:#fff;}
	#downloadExcel, #downloadExcelComplete {background:#24822c;}
	#questionBox {max-width:600px; margin:0 auto;}
	#questionBox>p {margin-bottom:30px; color:#ff69bc; text-decoration:underline; font-size:32px;} 
	#questionBox>label {display:inline-block; margin:0 20px 30px 20px;} 
	#myResult {margin-bottom:20px; font-size:26px; color:#ff69bc;}
	#mbtiDesc {margin-bottom:30px; font-size:18px; color:#444;}
	#groupMembers {margin-bottom:30px;}
	#groupMembers h4 {margin-bottom:20px;}
	#groupMembers li{margin-bottom:16px;}
	#remainingCount {margin-top:30px;}
</style>
</head>
<body>
<div class="wrap">

  <!-- 1ë‹¨ê³„ -->
  <div id="step1" class="section active">
	<dl class="title">
		<dt>í‹°ë‘ì´ í…ŒìŠ¤íŠ¸</dt>
		<dd>ë‚˜ëŠ” ë¬´ìŠ¨ í‹°ë‘ì´ì¼ê¹Œ?
			<img src="https://img.shoppingntmall.com/htmleditor/983/11761123283323.png" alt="">
		</dd>
	</dl>
	<div>
		<h3>ë¶€ì„œëª…ê³¼ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”</h3>
		<select id="team">
			<option value="">ì„ íƒ</option>
		</select>
		<!-- <input type="text" id="name" placeholder="ì´ë¦„ ì…ë ¥" /> -->
		 <select id="name" disabled>
			<option value="">ì´ë¦„ ì„ íƒ</option>
		</select>

		<br>
		<button id="startBtn">í…ŒìŠ¤íŠ¸ ì‹œì‘í•˜ê¸°</button>
	</div>
  </div>

  <!-- 2ë‹¨ê³„ -->
  <div id="step2" class="section">
	<dl class="title">
		<dt>í‹°ë‘ì´ í…ŒìŠ¤íŠ¸</dt>
		<dd><img src="https://img.shoppingntmall.com/htmleditor/851/221761180319269.png" alt=""></dd>
	</dl>
	<div>
		<h3>ê°„ë‹¨í•œ ì„±ê²© í…ŒìŠ¤íŠ¸</h3>
		<div id="questionBox"></div>
		<button id="nextQuestion">ë‹¤ìŒ ë¬¸í•­</button>
	</div>
  </div>

  <!-- 3ë‹¨ê³„ -->
  <div id="step3" class="section">
	<dl class="title">
		<dt>í‹°ë‘ì´ í…ŒìŠ¤íŠ¸</dt>
		<dd><img src="https://img.shoppingntmall.com/htmleditor/851/331761180319810.png" alt=""></dd>
	</dl>
	<div>
		<div class="result-box">
			<h3>ê²°ê³¼ í™•ì¸</h3>
			<p id="myResult"></p>
			<p id="mbtiDesc"></p>
			<div id="groupMembers"></div>
		</div>
		<button id="nextUserBtn">ë‹¤ìŒ ì‚¬ëŒ í…ŒìŠ¤íŠ¸ í•˜ê¸°</button>
		<button id="downloadExcel">ê²°ê³¼ ì—‘ì…€ë¡œ ë‹¤ìš´ë¡œë“œ</button>
	</div>
  </div>

  <div id="complete" class="section">
	<dl class="title">
		<dt>í‹°ë‘ì´ í…ŒìŠ¤íŠ¸</dt>
		<dd><img src="https://img.shoppingntmall.com/htmleditor/851/441761180320416.png" alt=""></dd>
	</dl>
	<div>
		<h2>ğŸ‰ ëª¨ë“  ì¸ì›ì´ í…ŒìŠ¤íŠ¸ë¥¼ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤! ğŸ‰ </h2>
		<p style="font-size:18px; line-height:26px; margin:30px 0">ëª¨ë“  ê²°ê³¼ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.<br>ì•„ë˜ ë²„íŠ¼ì„ ëˆŒëŸ¬ ì „ì²´ ê²°ê³¼ë¥¼ ë‹¤ìš´ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
		<button id="downloadExcelComplete">ê²°ê³¼ ì—‘ì…€ë¡œ ë‹¤ìš´ë¡œë“œ</button>
	</div>
  </div>
</div>

<script>
$(function(){  

  let participants = [];
  let mbtiGroups = {};
  let currentUser = {};

  // âœ… íŒ€ëª… + ì´ë¦„ ê²€ì¦ìš© ë¦¬ìŠ¤íŠ¸
  const validEntries = [
    {team:'ê²½ì˜ê¸°íšíŒ€', name:'ê¶Œìš©ë¯¼'},
    {team:'ê²½ì˜ê¸°íšíŒ€', name:'ì´ì‹œí˜„'},
    {team:'ê²½ì˜ê¸°íšíŒ€', name:'ì„œì˜ì„'},
    {team:'ê²½ì˜ê¸°íšíŒ€', name:'ì´ì„¸ì§„'},
    {team:'ì¸ì‚¬íŒ€', name:'ë‚¨ê·¼ìš°'},
    {team:'ì¸ì‚¬íŒ€', name:'ìµœìš©ìµ'},
    {team:'ì¸ì‚¬íŒ€', name:'ì •ìˆ˜ë¹ˆ'},
    {team:'ì¸ì‚¬íŒ€', name:'ê³½ì€ë¹„'},
    {team:'ì¬ë¬´íŒ€', name:'ë°±ê´€ë£¡'},
    {team:'ì¬ë¬´íŒ€', name:'ê¹€ì§€ì„ '},
    {team:'ì¬ë¬´íŒ€', name:'ì¡°ê²½ì¼'},
    {team:'ì¬ë¬´íŒ€', name:'ì´ì² ìˆ˜'},
    {team:'ì¬ë¬´íŒ€', name:'ë°•í•˜ì›'},
    {team:'ìƒìƒí˜‘ë ¥íŒ€', name:'ì–‘ìš°ì¼'},
    {team:'ìƒìƒí˜‘ë ¥íŒ€', name:'ì´í˜•ë¥ '},
    {team:'ìƒìƒí˜‘ë ¥íŒ€', name:'ìµœìœ¤ì„'},
    {team:'ìƒìƒí˜‘ë ¥íŒ€', name:'ê¹€ì—°ì£¼'},
    {team:'ìƒìƒí˜‘ë ¥íŒ€', name:'ë°•ìœ ì •'},
    {team:'ìƒìƒí˜‘ë ¥íŒ€', name:'ê¹€ë ¤ì›'},
    {team:'ìƒìƒí˜‘ë ¥íŒ€', name:'ì´í˜„ë²”'},
    {team:'ê³ ê°ì„œë¹„ìŠ¤íŒ€', name:'ì¥ìš°ì„'},
    {team:'ê³ ê°ì„œë¹„ìŠ¤íŒ€', name:'ì˜¤í™ì„'},
    {team:'ê³ ê°ì„œë¹„ìŠ¤íŒ€', name:'ì§€ê²½ì„'},
    {team:'ê³ ê°ì„œë¹„ìŠ¤íŒ€', name:'ë§ˆì€ì˜'},
    {team:'ê³ ê°ì„œë¹„ìŠ¤íŒ€', name:'ì„œêµì˜'},
    {team:'ê³ ê°ì„œë¹„ìŠ¤íŒ€', name:'ë°•ì°¬í›„'},
    {team:'ê³ ê°ì„œë¹„ìŠ¤íŒ€', name:'ì†¡ìˆ˜ë¯¼'},
    {team:'ê³ ê°ì„œë¹„ìŠ¤íŒ€', name:'í™©ì§€ì˜ˆ'},
    {team:'ì˜ì—…ê¸°íšíŒ€', name:'ê¹€íƒë´‰'},
    {team:'ì˜ì—…ê¸°íšíŒ€', name:'ì´í˜„ì›…'},
    {team:'ì˜ì—…ê¸°íšíŒ€', name:'ê¹€ì •ì„'},
    {team:'ì˜ì—…ê¸°íšíŒ€', name:'ì •ì„±ì€'},
    {team:'ì˜ì—…ê¸°íšíŒ€', name:'ê¹€ë¯¼ê²½'},
    {team:'ì˜ì—…ê¸°íšíŒ€', name:'ê¹€ê°€í¬'},
    {team:'ì˜ì—…ê¸°íšíŒ€', name:'ë°•ìƒˆì–€'},
    {team:'ì˜ì—…ê¸°íšíŒ€', name:'ì‹ ì§€ìœ¤'},
    {team:'ë§ˆì¼€íŒ…íŒ€', name:'ê¹€ë³´ëŒ'},
    {team:'ë§ˆì¼€íŒ…íŒ€', name:'í™ë¯¸ë¼'},
    {team:'ë§ˆì¼€íŒ…íŒ€', name:'ì •ì•„ë¦¼'},
    {team:'ë§ˆì¼€íŒ…íŒ€', name:'ê¹€ì •í›ˆ'},
    {team:'ë§ˆì¼€íŒ…íŒ€', name:'ì •ìˆ˜í˜„'},
    {team:'ë§ˆì¼€íŒ…íŒ€', name:'ì„ì§€í˜œ'},
    {team:'ë§ˆì¼€íŒ…íŒ€', name:'ê¹€ê²½ì£¼'},
    {team:'ë§ˆì¼€íŒ…íŒ€', name:'ê¹€ìƒìš°'},
    {team:'ë§ˆì¼€íŒ…íŒ€', name:'ì¥ë¯¸ì—°'},
    {team:'ë§ˆì¼€íŒ…íŒ€', name:'ì¥ìŠ¬ê¸°'},
    {team:'ë§ˆì¼€íŒ…íŒ€', name:'ì‹¬ì§€ì—°'},
    {team:'ë§ˆì¼€íŒ…íŒ€', name:'ì´ì§€ì˜'},
    {team:'ë§ˆì¼€íŒ…íŒ€', name:'ì´ì˜ì„œ'},
    {team:'í™ë³´íŒ€', name:'ìœ ì§€ì›'},
    {team:'ì˜ìƒì œì‘íŒ€', name:'ì‹¬ë„ì§„'},
    {team:'ì˜ìƒì œì‘íŒ€', name:'ì¥ë¬¸ì„'},
    {team:'ì˜ìƒì œì‘íŒ€', name:'ìµœì˜ì€'},
    {team:'ì˜ìƒì œì‘íŒ€', name:'ë°•ë¯¸ì •'},
    {team:'ì˜ìƒì œì‘íŒ€', name:'í•œì§€ìˆ˜'},
    {team:'ì˜ìƒì œì‘íŒ€', name:'ì •ì†Œì—°'},
    {team:'ì˜ìƒì œì‘íŒ€', name:'ì´ì¤€í˜„'},
    {team:'ì˜ìƒì œì‘íŒ€', name:'ê¹€ë¯¼'},
    {team:'ì˜ìƒì œì‘íŒ€', name:'ì•ˆìˆ˜ë¹ˆ'},
    {team:'ì˜ìƒì œì‘íŒ€', name:'ìµœí•˜ë‚˜'},
    {team:'ì˜ìƒì œì‘íŒ€', name:'ë°•ë™ê·œ'},
    {team:'ì˜ìƒì œì‘íŒ€', name:'ì›ì¢…ì„±'},
    {team:'ì˜ìƒì œì‘íŒ€', name:'ì†¡ì§„ì„ '},
    {team:'ì˜ìƒì œì‘íŒ€', name:'ê¹€ë¯¼ê²½'},
    {team:'ì˜ìƒì œì‘íŒ€', name:'ê¹€ì—°ì£¼'},
    {team:'ì˜ìƒì œì‘íŒ€', name:'ì‹ í˜œì›'},
    {team:'ì •ë³´ê¸°íšíŒ€', name:'ì´ë™ê·œ'},
    {team:'ì •ë³´ê¸°íšíŒ€', name:'ì‹ í˜ì¶˜'},
    {team:'ì •ë³´ê¸°íšíŒ€', name:'ë°©ê¸°ì •'},
    {team:'ì •ë³´ê¸°íšíŒ€', name:'ë¯¼ìœ¤ê²½'},
    {team:'ì •ë³´ê¸°íšíŒ€', name:'ë°±ì„±í˜„'},
    {team:'ì •ë³´ê¸°íšíŒ€', name:'ìµœìœ¤í˜¸'},
    {team:'ì •ë³´ê¸°íšíŒ€', name:'ì´ìš©í˜¸'},
    {team:'ì •ë³´ê¸°íšíŒ€', name:'ì •ì„¸ì² '},
    {team:'ì •ë³´ê¸°íšíŒ€', name:'ê¹€ì°½í™˜'},
    {team:'ì„œë¹„ìŠ¤ê¸°íšíŒ€', name:'ì´ì€ì£¼'},
    {team:'ì„œë¹„ìŠ¤ê¸°íšíŒ€', name:'í”¼ì„¤í˜„'},
    {team:'ì„œë¹„ìŠ¤ê¸°íšíŒ€', name:'ìµœí˜„ê·œ'},
    {team:'ì„œë¹„ìŠ¤ê¸°íšíŒ€', name:'ë°°ì§€ìˆ˜'},
    {team:'íŒ¨ì…˜ì˜ë¥˜íŒ€', name:'ì‹ ì€ë¯¸'},
    {team:'íŒ¨ì…˜ì˜ë¥˜íŒ€', name:'ì¡°ì¸ê·œ'},
    {team:'íŒ¨ì…˜ì˜ë¥˜íŒ€', name:'ìœ ìœ¤ê²½'},
    {team:'íŒ¨ì…˜ì˜ë¥˜íŒ€', name:'ì„œì¤€í˜¸'},
    {team:'íŒ¨ì…˜ì˜ë¥˜íŒ€', name:'í•¨ìˆ˜ì§€'},
    {team:'íŒ¨ì…˜ì˜ë¥˜íŒ€', name:'í˜„ì¤€'},
    {team:'íŒ¨ì…˜ì˜ë¥˜íŒ€', name:'ì„ìˆ˜ì—°'},
    {team:'íŒ¨ì…˜ì˜ë¥˜íŒ€', name:'ë°±í•˜ì€'},
    {team:'íŒ¨ì…˜ì¡í™”íŒ€', name:'ì´ì¤€ì„'},
    {team:'íŒ¨ì…˜ì¡í™”íŒ€', name:'í•˜ì—°ì£¼'},
    {team:'íŒ¨ì…˜ì¡í™”íŒ€', name:'ì¥ê²½ë¯¸'},
    {team:'íŒ¨ì…˜ì¡í™”íŒ€', name:'ì‹¬ì¬ìš©'},
    {team:'íŒ¨ì…˜ì¡í™”íŒ€', name:'í•œë‚¨í¬'},
    {team:'íŒ¨ì…˜ì¡í™”íŒ€', name:'ë¬¸í˜„'},
    {team:'íŒ¨ì…˜ì¡í™”íŒ€', name:'ì‹ ì—°ì‹'},
    {team:'íŒ¨ì…˜ì¡í™”íŒ€', name:'ì •ì˜ˆì§€'},
    {team:'íŒ¨ì…˜ì¡í™”íŒ€', name:'ì „ë‹¤ì¸'},
    {team:'í—¬ìŠ¤ë·°í‹°íŒ€', name:'ë°±ìŠ¹ì£¼'},
    {team:'í—¬ìŠ¤ë·°í‹°íŒ€', name:'ì¡°í˜œê²½'},
    {team:'í—¬ìŠ¤ë·°í‹°íŒ€', name:'ì„±í˜œì—°'},
    {team:'í—¬ìŠ¤ë·°í‹°íŒ€', name:'ì´ìˆ˜í˜„'},
    {team:'í—¬ìŠ¤ë·°í‹°íŒ€', name:'ì´ë‹¤í˜„'},
    {team:'í—¬ìŠ¤ë·°í‹°íŒ€', name:'ì •ì€ì„'},
    {team:'í—¬ìŠ¤ë·°í‹°íŒ€', name:'ê¹€ì§„ë•'},
    {team:'í—¬ìŠ¤ë·°í‹°íŒ€', name:'ê¹€í¬ì„±'},
    {team:'í‘¸ë“œíŒ€', name:'ìµœë™í™˜'},
    {team:'í‘¸ë“œíŒ€', name:'ì–‘ì›ì„'},
    {team:'í‘¸ë“œíŒ€', name:'ë°•ì§€ì•„'},
    {team:'í‘¸ë“œíŒ€', name:'ë°•ì§€ìˆ˜'},
    {team:'í‘¸ë“œíŒ€', name:'ì •ììœ¤'},
    {team:'í‘¸ë“œíŒ€', name:'ê¹€ì†Œí˜„'},
    {team:'í‘¸ë“œíŒ€', name:'ì •ì˜ˆì›'},
    {team:'ë¦¬ë¹™íŒ€', name:'í™ì˜ê¸°'},
    {team:'ë¦¬ë¹™íŒ€', name:'ë„ì¢…ì˜¤'},
    {team:'ë¦¬ë¹™íŒ€', name:'ì´í˜¸'},
    {team:'ë¦¬ë¹™íŒ€', name:'ê¹€ì„¸ê·¼'},
    {team:'ë¦¬ë¹™íŒ€', name:'ê¹€ë³‘ì¤€'},
    {team:'ë¦¬ë¹™íŒ€', name:'ì „ëª…ì„'},
    {team:'ë¬´í˜•ì„œë¹„ìŠ¤íŒ€', name:'ì„ë™í›ˆ'},
    {team:'ë¬´í˜•ì„œë¹„ìŠ¤íŒ€', name:'í•œì¬ì›…'},
    {team:'ë¬´í˜•ì„œë¹„ìŠ¤íŒ€', name:'ìµœì£¼í™˜'},
    {team:'ë¬´í˜•ì„œë¹„ìŠ¤íŒ€', name:'ë‚¨ìƒì¤€'},
    {team:'ê°ì‚¬íŒ€', name:'ì†ë¯¼ì² '},
    {team:'ê°ì‚¬íŒ€', name:'ì¡°íƒœìœ¤'}
  ];

    // âœ… validEntries ê¸°ë°˜ìœ¼ë¡œ select ì˜µì…˜ ìë™ ìƒì„±
	const uniqueTeams = [...new Set(validEntries.map(e => e.team))]; // ì¤‘ë³µ ì œê±°ëœ íŒ€ ëª©ë¡

	const $teamSelect = $('#team');
	$teamSelect.empty().append('<option value="">ì„ íƒ</option>'); // ê¸°ì¡´ ì´ˆê¸°í™”

	uniqueTeams.forEach(team => {
		$teamSelect.append(`<option value="${team}">${team}</option>`);
	});

  const totalParticipants = validEntries.length;// ì´ ì¸ì› ìˆ˜
  const groupSize = 6; // í•œ ì¡°ë‹¹ ì¸ì› ìˆ˜

  // âœ… MBTI ì„¤ëª…
  const mbtiDescriptions = {
    ENFJ: "ê³„íšì ì¸ ì²œì¬í˜• ë¦¬ë”! íŒ€ì›Œí¬ë¥¼ ì¤‘ìš”í•˜ê²Œ ìƒê°í•˜ê³  ëŠ˜ ì•ì¥ì„œëŠ” íƒ€ì… ğŸ’ª",
    INFJ: "ì¡°ìš©í•œ í˜ì‹ ê°€, ë‚¨ëª°ë˜ íŒ€ì„ ë¹›ë‚˜ê²Œ ë§Œë“œëŠ” ì „ëµê°€ ğŸŒŸ",
    ENTJ: "ì¹´ë¦¬ìŠ¤ë§ˆ ë¦¬ë”í˜•, ëª©í‘œ ë‹¬ì„±ì„ ìœ„í•´ íš¨ìœ¨ì ìœ¼ë¡œ ì›€ì§ì´ëŠ” ì¶”ì§„ë ¥ ê°‘ âš¡",
    INTJ: "ë¶„ì„í˜• ì²œì¬, ì‹œìŠ¤í…œì ìœ¼ë¡œ ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ” ì™„ë²½ì£¼ì˜ì ğŸ§ ",
    ENFP: "ì—´ì • í­ë°œí˜•, ì£¼ë³€ì„ ì—ë„ˆì§€ë¡œ ê°€ë“ ì±„ìš°ëŠ” ê¸ì • ì „ë„ì‚¬ ğŸ”¥",
    INFP: "ê°ì„±ì  ì´ìƒì£¼ì˜ì, ë°°ë ¤ ê¹Šê³  ì‚¬ëŒ ì¤‘ì‹¬ì˜ ë¶„ìœ„ê¸° ë©”ì´ì»¤ ğŸ’–",
    ENTP: "ì•„ì´ë””ì–´ ë±…í¬í˜•, ììœ ë¡œìš´ ë°œìƒìœ¼ë¡œ ë¬¸ì œë¥¼ ìƒˆë¡­ê²Œ í’€ì–´ë‚´ëŠ” ì°½ì˜í˜• ğŸ’¡",
    INTP: "ë…¼ë¦¬ ì¤‘ì‹¬í˜•, ì§€ì‹ìœ¼ë¡œ ë¬´ì¥í•œ ì•„ì´ë””ì–´ ì—°êµ¬ê°€ ğŸ”",
    ESFP: "ë¶„ìœ„ê¸° ë©”ì´ì»¤, ëª¨ë‘ë¥¼ ì¦ê²ê²Œ í•˜ëŠ” ì‚¬êµë ¥ ë§Œë ™ ğŸ˜",
    ISFP: "ë”°ëœ»í•œ ê°ì„±í˜•, ë¬µë¬µíˆ ì œ í•  ì¼ì„ ì™„ë²½íˆ í•´ë‚´ëŠ” ì˜ˆìˆ ê°€ ğŸŒˆ",
    ESTP: "ì‹¤í–‰ë ¥ ê°‘, ì¼ë‹¨ í•´ë³´ëŠ” ì¶”ì§„ë ¥ìœ¼ë¡œ ê²°ê³¼ë¥¼ ë§Œë“¤ì–´ë‚´ëŠ” í–‰ë™íŒŒ âš™ï¸",
    ISTP: "í˜„ì‹¤ í•´ê²°ì‚¬, ë¬¸ì œë¥¼ ë¹ ë¥´ê²Œ íŒŒì•…í•˜ê³  ì§ì ‘ í•´ê²°í•˜ëŠ” ì‹¤ë¬´í˜• ğŸ”§",
    ESFJ: "ì¹œì ˆí•œ í˜‘ë ¥ê°€, ëª¨ë‘ê°€ ì˜ ì§€ë‚´ë„ë¡ ì¡°ìœ¨í•˜ëŠ” ì¸ê°„ ë¹„íƒ€ë¯¼ â˜€ï¸",
    ISFJ: "í—Œì‹ ì ì¸ ìˆ˜í˜¸ì, íŒ€ì„ ë“ ë“ íˆ ì§€íƒ±í•˜ëŠ” ë¯¿ìŒì§í•œ ì¡´ì¬ ğŸ›¡ï¸",
    ESTJ: "ì²´ê³„ì ì¸ ê´€ë¦¬ì, ì›ì¹™ê³¼ íš¨ìœ¨ì„ ì¤‘ì‹œí•˜ëŠ” ì¡°ì§í˜• ë¦¬ë” ğŸ“‹",
    ISTJ: "ì„±ì‹¤í•œ ì™„ë²½ì£¼ì˜ì, ì•½ì†ì€ ë°˜ë“œì‹œ ì§€í‚¤ëŠ” ì±…ì„ê° ê°‘ ğŸ’¼"
  };

  const questions = [
    {q:"íšŒì˜ ì¤‘ ì•„ì´ë””ì–´ê°€ ë– ì˜¤ë¥´ë©´?", a1:{text:"ì¦‰ì‹œ ë§í•œë‹¤", value:"E"}, a2:{text:"ë‚˜ì¤‘ì— ì •ë¦¬í•´ì„œ ë§í•œë‹¤", value:"I"}},
    {q:"ìƒˆ í”„ë¡œì íŠ¸ë¥¼ ë§¡ìœ¼ë©´?", a1:{text:"í° ê·¸ë¦¼ë¶€í„° ë³¸ë‹¤", value:"N"}, a2:{text:"ì„¸ë¶€ ì‹¤í–‰ë¶€í„° ë– ì˜¬ë¦°ë‹¤", value:"S"}},
    {q:"ë™ë£Œê°€ ê³ ë¯¼ ìƒë‹´í•  ë•Œ?", a1:{text:"ë…¼ë¦¬ì ìœ¼ë¡œ í•´ê²°ì±… ì œì‹œ", value:"T"}, a2:{text:"ê°ì •ì ìœ¼ë¡œ ê³µê°í•´ì¤€ë‹¤", value:"F"}},
    {q:"ì—…ë¬´ ë§ˆê° ì „ë‚ ì´ë©´?", a1:{text:"ê³„íšëŒ€ë¡œ ì—¬ìœ ë¡­ê²Œ ëë‚¸ë‹¤", value:"J"}, a2:{text:"ëª°ì•„ì„œ í•œë²ˆì— í•œë‹¤", value:"P"}}
  ];

  let answers = [];
  let qIndex = 0;

  // âœ… íŒ€ ì„ íƒ ì‹œ, í•´ë‹¹ íŒ€ ì¸ì›ë§Œ ì´ë¦„ selectì— í‘œì‹œ
// âœ… íŒ€ ì„ íƒ ì‹œ, í•´ë‹¹ íŒ€ ì¸ì› í‘œì‹œ (ì™„ë£Œëœ ì¸ì›ì€ ë¹„í™œì„±í™”)
$('#team').on('change', function() {
  const selectedTeam = $(this).val();
  const $nameSelect = $('#name');
  $nameSelect.empty().append('<option value="">ì´ë¦„ ì„ íƒ</option>');

  if (!selectedTeam) return;

  const teamMembers = validEntries.filter(e => e.team === selectedTeam);

  if (teamMembers.length === 0) {
    $nameSelect.append('<option value="">íŒ€ì›ì´ ì—†ìŠµë‹ˆë‹¤</option>');
    $nameSelect.prop('disabled', true);
    return;
  }

  let allCompleted = true;
  teamMembers.forEach(e => {
    const isDone = participants.some(p => p.team === e.team && p.name === e.name);
    const label = isDone ? `${e.name} (ì™„ë£Œ)` : e.name;
    const disabled = isDone ? 'disabled' : '';
    $nameSelect.append(`<option value="${e.name}" ${disabled}>${label}</option>`);
    if (!isDone) allCompleted = false;
  });

  $nameSelect.prop('disabled', false);

  if (allCompleted) {
    $nameSelect.append('<option value="">ëª¨ë“  ì¸ì›ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤</option>');
    $nameSelect.prop('disabled', true);
  }
});
 

// âœ… íŒ€ ìƒíƒœ ê°±ì‹  (ì™„ë£Œëœ íŒ€ì€ ë¹„í™œì„±í™”)
function updateTeamSelect() {
  $('#team option').each(function() {
    const teamName = $(this).val();
    if (!teamName) return;

    const teamMembers = validEntries.filter(e => e.team === teamName);
    const completedMembers = participants.filter(p => p.team === teamName);

    // ëª¨ë“  ì¸ì›ì´ ì™„ë£Œëœ íŒ€ì´ë¼ë©´ ë¹„í™œì„±í™”
    if (teamMembers.length > 0 && teamMembers.length === completedMembers.length) {
      $(this).prop('disabled', true).text(`${teamName} (ì™„ë£Œ)`);
    }
  });
}


  // âœ… 1ë‹¨ê³„
  $('#startBtn').click(()=>{
    const team = $('#team').val();
    const name = $('#name').val().trim();
    if(!team || !name) return alert('ë¶€ì„œëª…ê³¼ ì´ë¦„ì„ ëª¨ë‘ ì„ íƒí•´ì£¼ì„¸ìš”.');

    const valid = validEntries.some(e => e.team === team && e.name === name);
    if(!valid) return alert('ë“±ë¡ëœ ì¸ì›ì´ ì•„ë‹™ë‹ˆë‹¤. ì •í™•íˆ ì„ íƒí•´ì£¼ì„¸ìš”.');

    currentUser = { team, name }; 
    $('#step1').removeClass('active');
    $('#step2').addClass('active');
    showQuestion();
  });

  // âœ… ì§ˆë¬¸ í‘œì‹œ
  function showQuestion(){
    const q = questions[qIndex];
    $('#questionBox').html(`
      <p><strong>${q.q}</strong></p>
      <label><input type="radio" name="answer" value="${q.a1.value}"> ${q.a1.text}</label><br>
      <label><input type="radio" name="answer" value="${q.a2.value}"> ${q.a2.text}</label>
    `);
  }

  $('#nextQuestion').click(()=>{
    const val = $('input[name="answer"]:checked').val();
    if(!val) return alert('ì§ˆë¬¸ ì¤‘ í•˜ë‚˜ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
    answers.push(val);
    qIndex++;
    if(qIndex < questions.length) showQuestion();
    else calculateResult();
  });

  // âœ… ê²°ê³¼ ê³„ì‚° ë° ì¡° í¸ì„±
  function calculateResult(){
    const mbti = answers.join('');
    if(!mbtiGroups[mbti]) mbtiGroups[mbti] = [];
    const groupNumber = Math.floor(mbtiGroups[mbti].length / groupSize) + 1;
    const groupName = `${mbti}-${groupNumber}ì¡°`;

    const userResult = {...currentUser, mbti, group: groupName};
    participants.push(userResult);
    mbtiGroups[mbti].push(userResult);

    $('#step2').removeClass('active');
    $('#step3').addClass('active');
    $('#myResult').text(`${userResult.name}ë‹˜ì€ ${mbti} ìœ í˜•ì´ë©°, ${groupName}ì— ë°°ì •ë˜ì—ˆìŠµë‹ˆë‹¤.`);
    $('#mbtiDesc').text(mbtiDescriptions[mbti] || 'í‹°ë‘ì´ë‹˜ì˜ íŠ¹ë³„í•œ ì„±ê²©ì´ì—ìš”!');

    renderGroupMembers(userResult.group);
    updateRemainingCount();

    // âœ… ì „ì²´ ì™„ë£Œ ì²´í¬
    if(participants.length >= totalParticipants){
      $('#step3').removeClass('active');
      $('#complete').addClass('active');
    }

    qIndex = 0;
    answers = [];

	updateTeamSelect();
  }

  // âœ… ì¡°ì› í‘œì‹œ
  function renderGroupMembers(groupName){
    const sameGroup = participants.filter(p => p.group === groupName);
    let list = `<h4>í˜„ì¬ ì¡° êµ¬ì„±ì›</h4><ul>`;
    sameGroup.forEach(p=>{
      list += `<li>${p.team} ${p.name} (${p.mbti})</li>`;
    });
    list += `</ul>`;
    $('#groupMembers').html(list);
  }

  // âœ… ë‚¨ì€ ì¸ì› ìˆ˜ í‘œì‹œ
  function updateRemainingCount(){
    const remaining = totalParticipants - participants.length;
    if(remaining > 0){
      if($('#remainingCount').length){
        $('#remainingCount').text(`ì•ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ë‚¨ì€ ì¸ì›: ${remaining}ëª…`);
      } else {
        $('<p id="remainingCount">').text(`ì•ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ë‚¨ì€ ì¸ì›: ${remaining}ëª…`)
          .insertAfter('#downloadExcel');
      }
    } else {
      $('#remainingCount').remove();
    }
  }

  // âœ… ì²˜ìŒìœ¼ë¡œ (ë‹¤ìŒ ì‚¬ëŒ)
  $('#nextUserBtn').click(()=>{
    if(participants.length >= totalParticipants){
      $('#step3').removeClass('active');
      $('#complete').addClass('active');
      return;
    }
    $('#team').val('');
    $('#name').val('');
    $('#groupMembers').empty();
    $('#step3').removeClass('active');
    $('#step1').addClass('active');
	$('#name').empty().append('<option value="">ì´ë¦„ ì„ íƒ</option>').prop('disabled', true);
	updateTeamSelect();
    window.scrollTo({top:0, behavior:'smooth'});
	
  });

  // âœ… ì—‘ì…€ ë‹¤ìš´ë¡œë“œ
	$('#downloadExcel').click(()=>{
	if (participants.length === 0) return alert('ì°¸ì—¬ìê°€ ì—†ìŠµë‹ˆë‹¤.');

	// í•œê¸€ ì»¬ëŸ¼ëª…ìœ¼ë¡œ ìƒˆ ë°°ì—´ ìƒì„±
	const exportData = participants.map(p => ({
		ë¶€ì„œëª…: p.team,
		ì´ë¦„: p.name,
		MBTI: p.mbti,
		ì¡°: p.group
	}));

	const ws = XLSX.utils.json_to_sheet(exportData); // âœ… exportDataë¡œ ë³€ê²½!
	const wb = XLSX.utils.book_new();
	XLSX.utils.book_append_sheet(wb, ws, "MBTI ì¡°í¸ì„±");
	XLSX.writeFile(wb, "í‹°ë‘ì´_ì¡°í¸ì„±ê²°ê³¼.xlsx");
	});


	// âœ… ì™„ë£Œ í™”ë©´ì—ì„œë„ ì—‘ì…€ ë‹¤ìš´ë¡œë“œ ê°€ëŠ¥í•˜ê²Œ
	$('#downloadExcelComplete').click(()=>{
	if (participants.length === 0) return alert('ì°¸ì—¬ìê°€ ì—†ìŠµë‹ˆë‹¤.');

	// í•œê¸€ ì»¬ëŸ¼ëª…ìœ¼ë¡œ ìƒˆ ë°°ì—´ ìƒì„±
	const exportData = participants.map(p => ({
		ë¶€ì„œëª…: p.team,
		ì´ë¦„: p.name,
		MBTI: p.mbti,
		ì¡°: p.group
	}));

	const ws = XLSX.utils.json_to_sheet(exportData); // âœ… exportDataë¡œ ë³€ê²½!
	const wb = XLSX.utils.book_new();
	XLSX.utils.book_append_sheet(wb, ws, "MBTI ì¡°í¸ì„±");
	XLSX.writeFile(wb, "í‹°ë‘ì´_ì¡°í¸ì„±ê²°ê³¼.xlsx");
	});


});
</script>
<script>
  // ì˜¤ë¥¸ìª½ í´ë¦­ ë°©ì§€
  document.addEventListener('contextmenu', e => e.preventDefault());
  // ë“œë˜ê·¸ ë°©ì§€
  document.addEventListener('dragstart', e => e.preventDefault());
  // í…ìŠ¤íŠ¸ ì„ íƒ ë°©ì§€
  document.addEventListener('selectstart', e => e.preventDefault());
  // Ctrl+C, Ctrl+U, F12 ë°©ì§€
  document.addEventListener('keydown', e => {
    if (
      (e.ctrlKey && (e.key === 'c' || e.key === 'u')) || // Ctrl+C, Ctrl+U
      e.key === 'F12' // ê°œë°œìë„êµ¬
    ) {
      e.preventDefault();
    }
  });
</script>
 
</body>
</html>