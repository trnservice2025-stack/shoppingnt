<!-- <script class="hidden" type="text/javascript" src="https://code.jquery.com/jquery-latest.min.js"></script> -->
<div class="promotion_con"><div class="promotion_con_mo">
  <div style="overflow:hidden; position:relative;">
    <canvas id="canvas"></canvas>
    <div class="base1">
      <img src="https://img.shoppingntmall.com/htmleditor/211/11680583290913.jpg" class="base2">
      <img src="https://img.shoppingntmall.com/htmleditor/862/ani1680583478409.png" class="ani anif">
    </div>
    <img src="https://img.shoppingntmall.com/htmleditor/494/21680583596593.jpg">
  </div>

  <img src="https://img.shoppingntmall.com/htmleditor/013/31680583603082.jpg" class="w20">
  <a href="/display/goods/12144567" class="w20"><img src="https://img.shoppingntmall.com/htmleditor/551/41680583610473.jpg"></a>
  <a href="/display/goods/11531203" class="w20"><img src="https://img.shoppingntmall.com/htmleditor/967/51680583617132.jpg"></a>
  <a href="/display/goods/10151605" class="w20"><img src="https://img.shoppingntmall.com/htmleditor/109/61680583624630.jpg"></a>
  <img src="https://img.shoppingntmall.com/htmleditor/013/31680583603082.jpg" class="w20">

  <a href="/display/goods/11531203" class="w50"><img src="https://img.shoppingntmall.com/htmleditor/991/81680583631853.jpg"></a>
  <a href="/display/goods/12682523" class="w50"><img src="https://img.shoppingntmall.com/htmleditor/574/91680583637238.jpg"></a>
  <a href="/display/goods/12682522" class="w50"><img src="https://img.shoppingntmall.com/htmleditor/470/101680583642642.jpg"></a>
  <a href="/display/goods/12682524" class="w50"><img src="https://img.shoppingntmall.com/htmleditor/668/111680583648406.jpg"></a>
</div></div>

<style media="screen">
  .base1 {position:relative; overflow:hidden; display:block;}
  .base2 {position:relative; z-index:1;}
  .base3 {position:absolute; width:100%; height:100%; top:0; left:0; z-index:3;}

  .ani {position:absolute; width:100%; left:0; z-index:2;}
  .anif {top:0; animation: anif 1s ease-in-out infinite; }

  @keyframes anif {
    0% {top:7px;}
    50% {top:0px;}
    100% {top:7px;}
  }

</style>

<style>
  .promotion_con {font-size:0; max-width:1200px; margin:0 auto;}
  .promotion_con .w20 {display:inline-block; width:20%; vertical-align:middle;}
  .promotion_con .w50 {display:inline-block; width:50%; vertical-align:middle;}
  .promotion_con img {width:100%; display:block;}

  @media screen and (max-width:720px)  {
    .promotion_con {overflow:hidden;}
    .promotion_con_mo {margin:0 -33.33%;}
  }
</style>


<style>
	canvas{z-index:10; pointer-events: none;position: absolute;top: 0; width:100%; left:0; transform: scale(1.1);}
</style>

<div class="buttonContainer" style="display:none;">
	<button class="canvasBtn" id="stopButton">Stop Confetti</button>
	<button class="canvasBtn" id="startButton">Drop Confetti</button>
</div>

<script type="text/javascript">
  (function () {
      // globals
      var canvas;
      var ctx;
      var W;
      var H;
      var mp = 150; //max particles
      var particles = [];
      var angle = 0;
      var tiltAngle = 0;
      var confettiActive = true;
      var animationComplete = true;
      var deactivationTimerHandler;
      var reactivationTimerHandler;
      var animationHandler;

      // objects

      var particleColors = {
          colorOptions: ["DodgerBlue", "OliveDrab", "Gold", "pink", "SlateBlue", "lightblue", "Violet", "PaleGreen", "SteelBlue", "SandyBrown", "Chocolate", "Crimson"],
          colorIndex: 0,
          colorIncrementer: 0,
          colorThreshold: 10,
          getColor: function () {
              if (this.colorIncrementer >= 10) {
                  this.colorIncrementer = 0;
                  this.colorIndex++;
                  if (this.colorIndex >= this.colorOptions.length) {
                      this.colorIndex = 0;
                  }
              }
              this.colorIncrementer++;
              return this.colorOptions[this.colorIndex];
          }
      }

      function confettiParticle(color) {
          this.x = Math.random() * W; // x-coordinate
          this.y = (Math.random() * H) - H; //y-coordinate
          this.r = RandomFromTo(10, 15); //radius;
          this.d = (Math.random() * mp) + 10; //density;
          this.color = color;
          this.tilt = Math.floor(Math.random() * 10) - 10;
          this.tiltAngleIncremental = (Math.random() * 0.07) + .05;
          this.tiltAngle = 0;

          this.draw = function () {
              ctx.beginPath();
              ctx.lineWidth = this.r / 2;
              ctx.strokeStyle = this.color;
              ctx.moveTo(this.x + this.tilt + (this.r / 4), this.y);
              ctx.lineTo(this.x + this.tilt, this.y + this.tilt + (this.r / 4));
              return ctx.stroke();
          }
      }

      $(document).ready(function () {
          SetGlobals();
          InitializeButton();
          //InitializeConfetti();

          $(window).resize(function () {
              W = window.innerWidth;
              H = window.innerHeight;
              canvas.width = W;
              canvas.height = H;
          });

      });

      function InitializeButton() {
          $('#stopButton').click(DeactivateConfetti);
          $('#startButton').click(RestartConfetti);
      }

      function SetGlobals() {
          canvas = document.getElementById("canvas");
          ctx = canvas.getContext("2d");
          W = window.innerWidth;
          H = window.innerHeight;
          canvas.width = W;
          canvas.height = H;
      }

      function InitializeConfetti() {
          particles = [];
          animationComplete = false;
          for (var i = 0; i < mp; i++) {
              var particleColor = particleColors.getColor();
              particles.push(new confettiParticle(particleColor));
          }
          StartConfetti();
      }

      function Draw() {
          ctx.clearRect(0, 0, W, H);
          var results = [];
          for (var i = 0; i < mp; i++) {
              (function (j) {
                  results.push(particles[j].draw());
              })(i);
          }
          Update();

          return results;
      }

      function RandomFromTo(from, to) {
          return Math.floor(Math.random() * (to - from + 1) + from);
      }


      function Update() {
          var remainingFlakes = 0;
          var particle;
          angle += 0.01;
          tiltAngle += 0.1;

          for (var i = 0; i < mp; i++) {
              particle = particles[i];
              if (animationComplete) return;

              if (!confettiActive && particle.y < -15) {
                  particle.y = H + 100;
                  continue;
              }

              stepParticle(particle, i);

              if (particle.y <= H) {
                  remainingFlakes++;
              }
              CheckForReposition(particle, i);
          }

          if (remainingFlakes === 0) {
              StopConfetti();
          }
      }

      function CheckForReposition(particle, index) {
          if ((particle.x > W + 20 || particle.x < -20 || particle.y > H) && confettiActive) {
              if (index % 5 > 0 || index % 2 == 0) //66.67% of the flakes
              {
                  repositionParticle(particle, Math.random() * W, -10, Math.floor(Math.random() * 10) - 20);
              } else {
                  if (Math.sin(angle) > 0) {
                      //Enter from the left
                      repositionParticle(particle, -20, Math.random() * H, Math.floor(Math.random() * 10) - 20);
                  } else {
                      //Enter from the right
                      repositionParticle(particle, W + 20, Math.random() * H, Math.floor(Math.random() * 10) - 20);
                  }
              }
          }
      }
      function stepParticle(particle, particleIndex) {
          particle.tiltAngle += particle.tiltAngleIncremental;
          particle.y += (Math.cos(angle + particle.d) + 3 + particle.r / 2) / 3;
          particle.x += Math.sin(angle);
          particle.tilt = (Math.sin(particle.tiltAngle - (particleIndex / 3))) * 15;
      }

      function repositionParticle(particle, xCoordinate, yCoordinate, tilt) {
          particle.x = xCoordinate;
          particle.y = yCoordinate;
          particle.tilt = tilt;
      }

      function StartConfetti() {
          W = window.innerWidth;
          H = window.innerHeight;
          canvas.width = W;
          canvas.height = H;
          (function animloop() {
              if (animationComplete) return null;
              animationHandler = requestAnimFrame(animloop);
              return Draw();
          })();
      }

      function ClearTimers() {
          clearTimeout(reactivationTimerHandler);
          clearTimeout(animationHandler);
      }

      function DeactivateConfetti() {
          confettiActive = false;
          ClearTimers();
      }

      function StopConfetti() {
          animationComplete = true;
          if (ctx == undefined) return;
          ctx.clearRect(0, 0, W, H);
      }

      function RestartConfetti() {
          ClearTimers();
          StopConfetti();
          reactivationTimerHandler = setTimeout(function () {
              confettiActive = true;
              animationComplete = false;
              InitializeConfetti();
          }, 100);

      }

      window.requestAnimFrame = (function () {
          return window.requestAnimationFrame ||
          window.webkitRequestAnimationFrame ||
          window.mozRequestAnimationFrame ||
          window.oRequestAnimationFrame ||
          window.msRequestAnimationFrame ||
          function (callback) {
              return window.setTimeout(callback, 1000 / 60);
          };
      })();
  })();

</script>

<script>
$(document).ready(function(){
  function reAction(){
  	$("#startButton").trigger("click");
  	setTimeout(function(){
  		$("#stopButton").trigger("click");
  	}, 8000);
  }
  reAction();
});
</script>
